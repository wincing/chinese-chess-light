{"version":3,"sources":["assets\\scripts\\CheckerBoard.js"],"names":["cc","Class","Component","properties","upperLeftX","upperLeftY","broadSize","gridWall","type","Prefab","gridPath","createGrid","position","kind","newGrid","instantiate","flag","nums","node","addChild","setSiblingIndex","anchorX","anchorY","newPosition","parent","convertToNodeSpaceAR","setPosition","createMap","flags","getComponents","i","map","Array","y","gridSize","j","x","v2","data","start","gridNum"],"mappings":";;;;;;AAAA;;;;;;;;;;;;;;;;;;;;AAoBAA,EAAE,CAACC,KAAH,CAAS;AACL,aAASD,EAAE,CAACE,SADP;AAGLC,EAAAA,UAAU,EAAE;AAERC,IAAAA,UAAU,EAAE,CAFJ;AAIRC,IAAAA,UAAU,EAAE,CAJJ;AAMRC,IAAAA,SAAS,EAAE,CANH;AAQRC,IAAAA,QAAQ,EAAE;AACN,iBAAS,IADH;AAENC,MAAAA,IAAI,EAAER,EAAE,CAACS;AAFH,KARF;AAaRC,IAAAA,QAAQ,EAAE;AACN,iBAAS,IADH;AAENF,MAAAA,IAAI,EAAER,EAAE,CAACS;AAFH;AAbF,GAHP;;AAsBL;;;;;;;AAOAE,EAAAA,UAAU,EAAE,oBAASC,QAAT,EAAmBC,IAAnB,EAAyB;AACjC,QAAIC,OAAO,GAAG,IAAd,CADiC,CAGjC;;AACA,YAAQD,IAAR;AACI,WAAK,CAAL;AACIC,QAAAA,OAAO,GAAGd,EAAE,CAACe,WAAH,CAAe,KAAKR,QAApB,CAAV;AACA;;AACJ,WAAK,CAAL;AACIO,QAAAA,OAAO,GAAGd,EAAE,CAACe,WAAH,CAAe,KAAKL,QAApB,CAAV;AACA;AANR,KAJiC,CAajC;;;AACAI,IAAAA,OAAO,CAACE,IAAR,GAAeH,IAAf;AACAC,IAAAA,OAAO,CAACG,IAAR,GAAe,CAAf;AAEA,SAAKC,IAAL,CAAUC,QAAV,CAAmBL,OAAnB,EAjBiC,CAmBjC;;AACAA,IAAAA,OAAO,CAACM,eAAR,CAAwB,CAAxB,EApBiC,CAsBjC;;AACAN,IAAAA,OAAO,CAACO,OAAR,GAAkB,CAAlB;AACAP,IAAAA,OAAO,CAACQ,OAAR,GAAkB,CAAlB,CAxBiC,CA0BjC;;AACA,QAAIC,WAAW,GAAGT,OAAO,CAACU,MAAR,CAAeC,oBAAf,CAAoCb,QAApC,CAAlB;AACAE,IAAAA,OAAO,CAACY,WAAR,CAAoBH,WAApB;AAEA,WAAOT,OAAP;AAEH,GA7DI;;AAgEL;;;AAGAa,EAAAA,SAAS,EAAE,qBAAW;AAClB,QAAIC,KAAK,GAAG,KAAKV,IAAL,CAAUW,aAAV,CAAwB7B,EAAE,CAACE,SAA3B,EAAsC,CAAtC,CAAZ,CADkB,CACoC;;AAEtD,SAAI,IAAI4B,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAG,EAAnB,EAAuBA,CAAC,EAAxB,EAA4B;AACxB,WAAKC,GAAL,CAASD,CAAT,IAAc,IAAIE,KAAJ,EAAd;AACA,UAAIC,CAAC,GAAG,KAAK5B,UAAL,GAAkByB,CAAC,GAAG,KAAKI,QAAnC;;AACA,WAAI,IAAIC,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAG,EAAnB,EAAuBA,CAAC,EAAxB,EAA4B;AACxB,YAAIC,CAAC,GAAG,KAAKhC,UAAL,GAAkB+B,CAAC,GAAG,KAAKD,QAAnC;AACA,aAAKH,GAAL,CAASD,CAAT,EAAYK,CAAZ,IAAiB,KAAKxB,UAAL,CAAgBX,EAAE,CAACqC,EAAH,CAAMD,CAAN,EAASH,CAAT,CAAhB,EAA6BL,KAAK,CAACU,IAAN,CAAWR,CAAX,EAAcK,CAAd,CAA7B,CAAjB;AACH;AACJ;AAEJ,GA/EI;AAiFLI,EAAAA,KAjFK,mBAiFI;AAEL,SAAKR,GAAL,GAAW,IAAIC,KAAJ,EAAX;AAEA,SAAKQ,OAAL,GAAe,EAAf;AAEA,SAAKN,QAAL,GAAgB,KAAK5B,SAAL,GAAe,KAAKkC,OAApC;AAEA,SAAKb,SAAL;AACH;AA1FI,CAAT","sourceRoot":"/","sourcesContent":["/**\r\n * 动态生成棋盘\r\n * @property {cc.Node} node 该脚本挂载的节点\r\n * \r\n * @property {Number} upperLeftX 棋盘左上角横坐标\r\n * \r\n * @property {Number} upperLeftY 棋盘左上角纵坐标\r\n * \r\n * @property {Number} broadSize 棋盘边长\r\n * \r\n * @property {cc.Prefab} gridWall 格子预制体资源-墙体\r\n * \r\n * @property {cc.Prefab} gridPath 格子预制体资源-路径\r\n * \r\n * @property {cc.Node[]} map 包含所有格子的数组\r\n * \r\n * @property {Number} gridNum 每边格子数--固定为10\r\n * \r\n * @property {Number} gridSize 格子大小\r\n */\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\r\n        upperLeftX: 0, \r\n\r\n        upperLeftY: 0, \r\n\r\n        broadSize: 0,\r\n       \r\n        gridWall: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n\r\n        gridPath: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },              \r\n    },\r\n\r\n    /**\r\n     * 动态生成格子并将其添加到场景中\r\n     * \r\n     * @param {cc.V2} position 生成格子的位置\r\n     * @param {Boolean} kind 格子的类型\r\n     * @returns {Grid} 生成格子的引用\r\n     */\r\n    createGrid: function(position, kind) {\r\n        var newGrid = null;\r\n\r\n        // 根据格子种类生成节点\r\n        switch (kind) {\r\n            case 0:\r\n                newGrid = cc.instantiate(this.gridWall);\r\n                break;\r\n            case 1:\r\n                newGrid = cc.instantiate(this.gridPath);\r\n                break;\r\n        }\r\n\r\n        // 0为墙, 1为路, 2为灯, 3为受攻击\r\n        newGrid.flag = kind;\r\n        newGrid.nums = 0;\r\n\r\n        this.node.addChild(newGrid);\r\n\r\n        // 设置格子层级\r\n        newGrid.setSiblingIndex(2); \r\n\r\n        // 使每个格子以左上角为锚点\r\n        newGrid.anchorX = 0;\r\n        newGrid.anchorY = 1;\r\n        \r\n        // 设置格子位置\r\n        var newPosition = newGrid.parent.convertToNodeSpaceAR(position);\r\n        newGrid.setPosition(newPosition);\r\n\r\n        return newGrid;\r\n\r\n    },\r\n\r\n\r\n    /**\r\n     * 创建棋盘\r\n     */\r\n    createMap: function() {\r\n        var flags = this.node.getComponents(cc.Component)[1]; // 关卡数据脚本一定需挂在第3位置\r\n\r\n        for(var i = 0; i < 10; i++) {\r\n            this.map[i] = new Array();\r\n            var y = this.upperLeftY - i * this.gridSize;\r\n            for(var j = 0; j < 10; j++) {\r\n                var x = this.upperLeftX + j * this.gridSize;\r\n                this.map[i][j] = this.createGrid(cc.v2(x, y), flags.data[i][j]);\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    start () {\r\n\r\n        this.map = new Array();\r\n\r\n        this.gridNum = 10;\r\n \r\n        this.gridSize = this.broadSize/this.gridNum;\r\n\r\n        this.createMap();\r\n    },\r\n\r\n});\r\n"]}